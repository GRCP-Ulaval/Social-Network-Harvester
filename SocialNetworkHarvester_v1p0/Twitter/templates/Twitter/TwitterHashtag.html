{% extends "MainPage.html" %}
{% load staticfiles %}

{% block Title %}SNH | {{ hashtag }}{% endblock %}


{% block extendHead %}
<link rel="stylesheet" type="text/css" href='{% static "css/table_style.css" %}' name="style">
<script type="text/javascript" src='{% static "js/table_script.js" %}'></script>
{% endblock %}

{% block content %}
<section class="overviewContainer yetToCome">
    <div class="section_menu">
            <span class="section_title">
                <b>Overview</b>
            </span>
    </div>
    <div class="section_overview_content">
        -- STATISTIQUES DIVERSES --
    </div>
</section>

<!-- TWEETS -->
<section class="tableContainer">
    <div class="section_menu">
            <span class="section_title">
                <b>Tweets</b>
            </span>
        <div class="section_options">
            <span>|</span>
            <span id="downloadAllTweets" class="section_menuItem">Download selection</span>
            <span>|</span>
            <span id="reloadTableLink" class="section_menuItem">Reload table</span>
            <span>|</span>
            <span><input type="checkbox" name="exclude_retweets" class="option_checkbox"> Exclude retweets</span>
        </div>
        <div class="tableOpenCloseIcon" type="plus">
            <img src="{% static 'medias/plus_icon_128.png' %}" style="height:100%;">
        </div>
    </div>

    <div class="section_content">
        <table class="display" id="tweet_table" width="100%" drawn='False'>
            <thead>
            <tr>
                <th><input type="checkbox" class='table_select_master'></input></th>
                <th>Date</th>
                <th>Author</th>
                <th>Text</th>
                <th>Retweets</th>
                <th></th>
            </tr>
            </thead>
            <script class="tableVars">
                var fields = "created_at,user,text,retweet_count,_ident";
                var url = "/twitter/TWTweetTable/";
                var GETValues = ["selected_rows=Hashtag_{{ hashtag.pk }}"];
                var languageParams = {
                    "zeroRecords": "No data available.",
                    "thousands": ",",
                };
                var columnsDefs = [
                    {
                        "orderable": false,
                        "className": 'select-checkbox',
                        "targets": 0,
                        "render": function () {
                            return ""
                        }
                    },
                    {
                        "targets": 1,
                        "searchable": false,
                        "asSorting": default_asSorting,
                        "render": function (data, type, row) {
                            return row['created_at'];
                        }
                    },
                    {
                        "targets": 2,
                        "searchable": true,
                        "asSorting": default_asSorting,
                        "render": function (data, type, row) {
                            if (row['user'] == null) {
                                return "<i>undefined</i>"
                            }
                            return '<a href="/twitter/user/' + row['user'] + '" class="TableToolLink snippetHover">' + row['user'] + '</a>';
                        }
                    },
                    {
                        "targets": 3,
                        "asSorting": default_asSorting,
                        "render": function (data, type, row) {
                            return formatTweetText(row['text']);
                        }
                    },
                    {
                        "targets": 4,
                        "asSorting": default_asSorting,
                        "render": function (data, type, row) {
                            return row['retweet_count'];
                        }
                    },
                    {
                        "targets": 5,
                        "searchable": false,
                        "orderable": false,
                        "render": function (data, type, row) {
                            return '<a href="/twitter/tweet/' + row["_ident"] + '" class="TableToolLink">' + 'more infos' + '</a>';
                        }
                    },
                ];
            </script>
        </table>
    </div>
</section>

{% endblock %}